# 第六章：界面组件

## 6.1 界面组件概述

在 Android 应用开发中，界面组件（Widgets/Views）是构成用户界面的基本元素。它们包括按钮、文本框、图片展示等各种可视化的控件。

本项目包含了大量的自定义界面组件，这些组件不仅提高了开发效率，还保证了界面风格的统一性。

## 6.2 基础组件

### TextView 相关组件

#### ClearEditText 带清除按钮的输入框

[ClearEditText](file:///D:/git/app/AndroidProject/library/widget/src/main/java/com/hjq/widget/view/ClearEditText.java#L27-L115) 是一个带有清除按钮的输入框，用户输入内容后会自动显示清除按钮，点击可以清空输入内容。

使用方法：
```xml
<com.hjq.widget.view.ClearEditText
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:hint="请输入内容" />
```

#### RegexEditText 正则表达式输入框

[RegexEditText](file:///D:/git/app/AndroidProject/library/widget/src/main/java/com/hjq/widget/view/RegexEditText.java#L24-L141) 可以通过正则表达式限制用户输入的内容类型。

常见用法：
```java
// 限制只能输入手机号
regexEditText.setPatternRegex(RegexEditText.REGEX_MOBILE);

// 限制只能输入数字
regexEditText.setPatternRegex(RegexEditText.REGEX_NUMBER);

// 限制只能输入中文
regexEditText.setPatternRegex(RegexEditText.REGEX_CHINESE);
```

#### PasswordEditText 密码输入框

[PasswordEditText](file:///D:/git/app/AndroidProject/library/widget/src/main/java/com/hjq/widget/view/PasswordEditText.java#L28-L161) 是专门用于密码输入的组件，具有密码显示/隐藏切换功能。

```xml
<com.hjq.widget.view.PasswordEditText
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:hint="请输入密码"
    android:inputType="textPassword" />
```

### 按钮相关组件

#### SwitchButton 开关按钮

[SwitchButton](file:///D:/git/app/AndroidProject/library/widget/src/main/java/com/hjq/widget/view/SwitchButton.java#L44-L330) 是一个仿 iOS 风格的开关按钮组件。

使用示例：
```java
SwitchButton switchButton = findViewById(R.id.switch_button);

// 设置开关状态变化监听
switchButton.setOnCheckedChangeListener((buttonView, isChecked) -> {
    if (isChecked) {
        // 开启状态
    } else {
        // 关闭状态
    }
});
```

## 6.3 布局组件

### StatusLayout 状态布局

[StatusLayout](file:///D:/git/app/AndroidProject/app/src/main/java/run/yigou/gxzy/widget/StatusLayout.java#L31-L339) 是一个用于显示不同状态的布局组件，常用于网络请求时显示加载、错误、空数据等状态。

主要功能：
- 显示加载中状态
- 显示空数据状态
- 显示错误状态
- 支持重试操作

使用方法：
```java
StatusLayout statusLayout = findViewById(R.id.status_layout);

// 显示加载中
statusLayout.showLoading();

// 显示错误状态
statusLayout.showError("网络连接失败");

// 显示空数据状态
statusLayout.showEmpty();

// 设置重试监听
statusLayout.setOnRetryListener(v -> {
    // 重新加载数据
});
```

### WrapRecyclerView 包装列表

[WrapRecyclerView](file:///D:/git/app/AndroidProject/library/widget/src/main/java/com/hjq/widget/layout/WrapRecyclerView.java#L26-L177) 是一个增强版的 RecyclerView，支持添加头部和底部视图。

使用示例：
```java
WrapRecyclerView recyclerView = findViewById(R.id.recycler_view);

// 添加头部视图
recyclerView.addHeaderView(R.layout.header_layout);

// 添加底部视图
recyclerView.addFooterView(R.layout.footer_layout);

// 设置适配器
recyclerView.setAdapter(adapter);
```

## 6.4 浏览器组件

### BrowserView 浏览器视图

[BrowserView](file:///D:/git/app/AndroidProject/app/src/main/java/run/yigou/gxzy/widget/BrowserView.java#L28-L179) 是基于 WebView 封装的浏览器组件，提供了更便捷的网页加载功能。

主要特性：
- 支持文件下载
- 支持 JavaScript 交互
- 支持页面生命周期管理
- 集成了常用的 WebView 设置

使用方法：
```java
BrowserView browserView = findViewById(R.id.browser_view);

// 设置浏览器回调
browserView.setBrowserCallback(new BrowserView.BrowserCallback() {
    @Override
    public void onPageStarted() {
        // 页面开始加载
    }
    
    @Override
    public void onPageFinished() {
        // 页面加载完成
    }
    
    @Override
    public void onReceivedError(int errorCode, String description) {
        // 页面加载出错
    }
});

// 加载网页
browserView.loadUrl("https://www.baidu.com");
```

## 6.5 多媒体组件

### PlayerView 播放器视图

[PlayerView](file:///D:/git/app/AndroidProject/app/src/main/java/run/yigou/gxzy/widget/PlayerView.java#L30-L357) 是一个视频播放器组件，支持手势控制音量、亮度和播放进度。

主要功能：
- 视频播放控制
- 手势调节音量和亮度
- 全屏播放支持
- 锁定屏幕控制

使用示例：
```java
PlayerView playerView = findViewById(R.id.player_view);

// 设置播放监听
playerView.setPlayListener(new PlayerView.OnPlayListener() {
    @Override
    public void onPlayStart() {
        // 开始播放
    }
    
    @Override
    public void onPlayStop() {
        // 停止播放
    }
});

// 设置视频路径并开始播放
playerView.setVideoPath("视频文件路径");
playerView.start();
```

## 6.6 自定义对话框组件

项目中定义了多种自定义对话框，都继承自 [BaseDialog](file:///D:/git/app/AndroidProject/library/base/src/main/java/com/hjq/base/BaseDialog.java#L33-L828)。

### CommonDialog 通用对话框

用于显示简单的提示信息和确认操作。

```java
new CommonDialog.Builder(this)
    .setTitle("提示")
    .setMessage("确定要删除这条记录吗？")
    .setConfirm("确定")
    .setCancel("取消")
    .setListener(new CommonDialog.OnListener() {
        @Override
        public void onConfirm(BaseDialog dialog) {
            // 确定按钮点击事件
        }
        
        @Override
        public void onCancel(BaseDialog dialog) {
            // 取消按钮点击事件
        }
    })
    .show();
```

### 输入对话框

用于接收用户输入信息。

```java
new InputDialog.Builder(this)
    .setTitle("请输入姓名")
    .setContent("张三")
    .setHint("请输入您的姓名")
    .setConfirm("确定")
    .setCancel("取消")
    .setListener(new InputDialog.OnListener() {
        @Override
        public void onConfirm(BaseDialog dialog, String content) {
            // 获取用户输入的内容
        }
    })
    .show();
```

## 6.7 项目特有的自定义组件

### TipsLittleTextViewWindow 小窗口提示组件

这是项目中特有的一个小窗口提示组件，用于在屏幕上显示浮动提示信息。

使用方法：
```java
TipsLittleTextViewWindow tipsWindow = new TipsLittleTextViewWindow();
tipsWindow.setText("这是提示信息");
tipsWindow.show(getSupportFragmentManager());
```

### LocalLinkMovementMethod 链接移动方法

用于处理 TextView 中的链接点击事件。

```java
TextView textView = findViewById(R.id.text_view);
textView.setMovementMethod(LocalLinkMovementMethod.getInstance());
```

## 6.8 组件使用最佳实践

### 组件初始化

在 Activity 或 Fragment 中正确初始化组件：

```java
public class MainActivity extends AppActivity {
    
    private StatusLayout mStatusLayout;
    private BrowserView mBrowserView;
    
    @Override
    protected void initView() {
        mStatusLayout = findViewById(R.id.status_layout);
        mBrowserView = findViewById(R.id.browser_view);
        
        // 初始化组件
        initStatusLayout();
        initBrowserView();
    }
    
    private void initStatusLayout() {
        mStatusLayout.setOnRetryListener(v -> {
            // 重试逻辑
            loadData();
        });
    }
    
    private void initBrowserView() {
        mBrowserView.setBrowserCallback(new BrowserView.BrowserCallback() {
            @Override
            public void onPageStarted() {
                mStatusLayout.showLoading();
            }
            
            @Override
            public void onPageFinished() {
                mStatusLayout.hide();
            }
        });
    }
}
```

### 组件生命周期管理

注意在适当的生命周期方法中处理组件的状态：

```java
@Override
protected void onResume() {
    super.onResume();
    // 恢复组件状态
    if (mBrowserView != null) {
        mBrowserView.onResume();
    }
}

@Override
protected void onPause() {
    super.onPause();
    // 暂停组件状态
    if (mBrowserView != null) {
        mBrowserView.onPause();
    }
}

@Override
protected void onDestroy() {
    super.onDestroy();
    // 销毁组件资源
    if (mBrowserView != null) {
        mBrowserView.onDestroy();
    }
}
```

## 本章小结

这一章我们学习了：

1. 项目中各种自定义界面组件的功能和使用方法
2. 基础组件如输入框、按钮等的使用
3. 布局组件如状态布局、包装列表等的应用
4. 浏览器和多媒体组件的使用
5. 对话框组件的创建和使用
6. 项目特有的自定义组件
7. 组件的最佳实践和生命周期管理

掌握这些界面组件的使用，可以帮助你构建更加丰富和用户友好的界面。